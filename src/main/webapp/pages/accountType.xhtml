<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:head>

</h:head>
<h:body>
	<ui:composition template="/templates/main-template.xhtml">
		<ui:define name="title">
			<h:outputText value="#{msg['accountType.page.title']}" />
			<div>
				<p:growl id="growlMsg" showDetail="true" />
			</div>
		</ui:define>
		<ui:define name="content">
			<h:form id="form">
				<div>
					<p:growl id="growlMsg" showDetail="true" />
				</div>
				<div>
					<p:dataTable id="accountTypeList"
						value="#{accountTypeBean.accountTypeList}" var="e"
						rowkey="#{e.id}" editable="true"
						emptyMessage="#{msg['global.table.empty']}">
						<p:ajax event="rowEdit" listener="#{accountTypeBean.onRowEdit}"
							update="@this" />
						<p:ajax event="rowEditCancel"
							listener="#{accountTypeBean.onRowCancel}" update="@this" />

						<p:column headerText="#{msg['accountType.id']}">
							<h:outputText value="#{e.id}" />
						</p:column>
						<p:column headerText="#{msg['accountType.description']}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{e.description}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{e.description}" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="#{msg['accountType.hasValidityPeriod']}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="" rendered="#{not e.hasValidityPeriod}" />
									<h:outputText value="X" rendered="#{e.hasValidityPeriod}" />
								</f:facet>
								<f:facet name="input">
									<p:selectBooleanCheckbox id="hasValidityPeriod"
										widgetVar="hasValidityPeriodWidget"
										value="#{e.hasValidityPeriod}"
										onchange="changeHasValidityPeriod();" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="#{msg['accountType.from']}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{e.from}">
										<f:convertDateTime pattern="#{msg['global.date.pattern']}" />
									</h:outputText>
								</f:facet>
								<f:facet name="input">
									<p:calendar id="from" widgetVar="fromWidget" value="#{e.from}"
										pattern="#{msg['global.date.pattern']}" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="#{msg['accountType.to']}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{e.to}">
										<f:convertDateTime pattern="#{msg['global.date.pattern']}" />
									</h:outputText>
								</f:facet>
								<f:facet name="input">
									<p:calendar id="to" value="#{e.to}" widgetVar="toWidget"
										pattern="#{msg['global.date.pattern']}" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="#{msg['accountType.order']}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{e.order}" />
								</f:facet>
								<f:facet name="input">
									<p:spinner value="#{e.order}" min="#{msg['global.order.min']}"
										max="#{msg['global.order.max']}" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="#{msg['accountType.enabled']}">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="" rendered="#{not e.enabled}" />
									<h:outputText value="X" rendered="#{e.enabled}" />
								</f:facet>
								<f:facet name="input">
									<p:selectBooleanCheckbox value="#{e.enabled}" />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column>
							<p:rowEditor>
								<p:ajaxStatus onstart="enablePeriodDateFields();" />
							</p:rowEditor>
						</p:column>
					</p:dataTable>
					<p:commandButton value="#{msg['global.new']}" />
				</div>

				<p:panelGrid  id="newFieldsDiv" widgetVar="newFieldsDivWidget" border="2">
					<h:outputText value="#{msg['accountType.description']}:" />
					<h:inputText value="#{accountType.accountType.description}" />
					<h:outputText value="#{msg['accountType.hasValidityPeriod']}:" />
					<p:selectBooleanCheckbox id="newHasValidityPeriod"
						widgetVar="newHasValidityPeriodWidget"
						value="#{accountType.accountType.hasValidityPeriod}"
						onchange="newChangeHasValidityPeriod();" />
					<h:outputText value="#{msg['accountType.from']}:" />
					<p:calendar id="newFrom" widgetVar="newFromWidget"
						value="#{accountType.accountType.from}"
						pattern="#{msg['global.date.pattern']}" />
					<h:outputText value="#{msg['accountType.to']}:" />
					<p:calendar id="newTo" value="#{accountType.accountType.to}"
						widgetVar="newToWidget" pattern="#{msg['global.date.pattern']}" />
					<h:outputText value="#{msg['accountType.order']}:" />
					<p:spinner value="#{accountType.accountType.order}"
						min="#{msg['global.order.min']}" max="#{msg['global.order.max']}" />
					<h:outputText value="#{msg['accountType.enabled']}:" />
					<p:selectBooleanCheckbox value="#{accountType.accountType.enabled}" />
					<p:commandButton value="#{msg['global.save']}" />
				</p:panelGrid>
			</h:form>
			<script type="text/javascript">
			function changeHasValidityPeriod(){
				if (PF('hasValidityPeriodWidget').isChecked()){
					PF('fromWidget').setDate(new Date());
					PF('fromWidget').enable();
					PF('toWidget').setDate(new Date());
					PF('toWidget').enable();
				}
				else{
					PF('fromWidget').setDate(null);
					PF('fromWidget').disable();
					PF('toWidget').setDate(null);
					PF('toWidget').disable();
				}
				return true;
			}	
			function enablePeriodDateFields(){
				PF('fromWidget').enable();
				PF('toWidget').enable();
				return true;
			}	
			alert(PF('newFieldsDiv'));
			</script>
		</ui:define>
	</ui:composition>
</h:body>
</html>
